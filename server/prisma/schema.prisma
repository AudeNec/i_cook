generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model List {
  id          Int               @id @default(autoincrement())
  createdAt   DateTime          @default(now())
  updatedAt   DateTime          @updatedAt

  ingredients List_ingredient[] @relation("ListToIngredients")
}

model Recipe {
  id        Int                  @id @default(autoincrement())
  name      String @unique
  createdAt DateTime             @default(now())

  ingredients Recipe_ingredient[]
}

model Ingredient {
  id   Int    @id @default(autoincrement())
  name String @unique
  unit String
  
  recipes Recipe_ingredient[]
  lists List_ingredient[]
}

model Recipe_ingredient {
  recipeId     Int
  ingredientId Int

  recipe       Recipe     @relation(fields: [recipeId], references: [id])
  ingredient   Ingredient @relation(fields: [ingredientId], references: [id])
  
  quantity     Float

  listRecipeIngredients List_Recipe_Ingredient[]

  @@id([recipeId, ingredientId])
}

model List_ingredient {
  listId       Int
  ingredientId Int

  list         List       @relation("ListToIngredients", fields: [listId], references: [id])
  ingredient   Ingredient @relation(fields: [ingredientId], references: [id])
  
  recipeIngredients List_Recipe_Ingredient[]

  bought       Boolean @default(false)

  @@id([listId, ingredientId])
}

model List_Recipe_Ingredient {
  listId             Int
  ingredientId       Int
  recipeId           Int
  recipeIngredientId Int

  listIngredient     List_ingredient   @relation(fields: [listId, ingredientId], references: [listId, ingredientId])
  recipeIngredient   Recipe_ingredient @relation(fields: [recipeId, recipeIngredientId], references: [recipeId, ingredientId])

  @@id([listId, ingredientId, recipeId, recipeIngredientId])
}